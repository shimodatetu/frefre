<% threadtype_id = @threadtype.id %>
<% if logged_in? %>
  <div class="explain_join_button join_button_cover join_button<%= threadtype_id%>">
    <%= link_to("/login_page",class:"login_join_button btn mes_button join_button") do %>
      <div class="text_box">
        <div class="jp">
          Login / ログインする
        </div>
      </div>
    <% end %>
  </div>
<% else %>
  <div class="explain_join_button join_button_cover join_button<%= threadtype_id%>">
    <% if (current_user.threadtypes.find_by(id:threadtype_id) != nil || @threadtype.leader_id == current_user.id)%>
      <%= button_tag type:"button",class:"btn mes_button join_button unjoin_button_submit",id:threadtype_id,style:"cursor:default" do %>
        <div class="text_box">
          <div class="jp">
            Joined Community / 参加済コミュニティ
          </div>
        </div>
      <% end %>
    <% else %>
      <% if @threadtype.approval == "approval" %>
        <% if current_user.approvals.find_by(threadtype_id:threadtype_id) != nil %>
          <%= button_tag type:"button",class:"btn mes_button join_button approved_button_submit click",id:threadtype_id do %>
            <div class="text_box">
              <div class="jp">
                You Approved Community / コミュニティ参加申請済み
              </div>
            </div>
          <% end %>
        <% else %>
          <%= button_tag type:"button",class:"btn mes_button join_button approves_button_submit click",id:threadtype_id do %>
            <div class="text_box">
              <div class="jp">
                Approve this Community / コミュニティに参加申請する
              </div>
            </div>
          <% end %>
        <% end %>
      <% else %>
        <%= button_tag type:"button",class:"btn mes_button join_button join_button_submit click",id:threadtype_id do %>
          <div class="text_box">
            <div class="jp">
              Join this Community / このコミュニティに参加する
            </div>
          </div>
        <% end %>
      <% end %>
    <% end %>
  </div>
<% end %>